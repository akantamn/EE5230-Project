%This solution to HW2 uses the MATPOWER package developed by Zimmerman et
%al at Cornell University. The code is distributed under GPL licence. I
%have used MATPOWER before for solving power flow and optimal power flow
%problems, the code can support hundred if not thousands of busses. 


%The given problem statement is encapsulated in the form of a MATPOWER data
%structure, the file in this homework is case3a.m

[bus, gen, branch, f, success]=dcopf('case3a');

%dcopf.m uses the MATPOWER's opf function to solve DC Optimal Power Flow
%problem. More details are available here. 

%Print results
format short
B=[0.3,-0.1,-0.2;-0.1,0.25,-0.15;-0.2,
fprintf('\n Solutions to HW2 \n \nThe total cost of operation is $ %0.2f \n',f);
fprintf('\nGenerators Optimal Dispatch: \n Gen1 \t %0.2f MW\n Gen2 \t %0.2f MW\n Gen3 \t %0.2f MW\n',gen(1,2),gen(2,2),gen(3,2));
fprintf('\nPower Angles at each Bus: \n Bus 1 \t %0.4f (deg)\t (Reference Bus)\n Bus 2 \t %0.4f (deg)\n Bus 3 \t %0.4f (deg)\n',bus(1,9),bus(2,9),bus(3,9));
fprintf('\nLMP at each Bus: \n Bus 1 \t $%0.2f\n Bus 2 \t $%0.2f\n Bus 3 \t $%0.2f\n',bus(1,14),bus(2,14),bus(3,14));
fprintf('\nPower from in each transmission line: \n From \t To \t Power Flow \n');
for i=1:3
    fprintf(' %d \t %d \t %0.2f MW\n',branch(i,1),branch(i,2),branch(i,14));
end

condition=0;
while condition==0
    
str=input('\n \n Print more detailed results? [Y/N]: ','s');
if strcmp(str,'Y')==1 || strcmp(str,'y')==1
    dcopf('case3a')
    fprintf('\n \n End of report! Thanks\n');

    condition=1;
elseif strcmp(str,'N')==1 || strcmp(str,'n')==1
    fprintf('\n \n End of report! Thanks\n');
    condition=1;
else
    fprintf('\n Wrong input try again: ');
    condition=0;
end
end


